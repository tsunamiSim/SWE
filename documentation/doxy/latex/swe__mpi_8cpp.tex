\hypertarget{swe__mpi_8cpp}{\section{src/examples/swe\-\_\-mpi.cpp File Reference}
\label{swe__mpi_8cpp}\index{src/examples/swe\-\_\-mpi.\-cpp@{src/examples/swe\-\_\-mpi.\-cpp}}
}
{\ttfamily \#include $<$algorithm$>$}\\*
{\ttfamily \#include $<$cassert$>$}\\*
{\ttfamily \#include $<$cmath$>$}\\*
{\ttfamily \#include $<$cstdlib$>$}\\*
{\ttfamily \#include $<$mpi.\-h$>$}\\*
{\ttfamily \#include $<$string$>$}\\*
{\ttfamily \#include $<$vector$>$}\\*
{\ttfamily \#include \char`\"{}blocks/\-S\-W\-E\-\_\-\-Wave\-Propagation\-Block.\-hh\char`\"{}}\\*
{\ttfamily \#include \char`\"{}blocks/\-S\-W\-E\-\_\-\-Wave\-Accumulation\-Block.\-hh\char`\"{}}\\*
{\ttfamily \#include \char`\"{}writer/\-Vtk\-Writer.\-hh\char`\"{}}\\*
{\ttfamily \#include \char`\"{}scenarios/\-S\-W\-E\-\_\-simple\-\_\-scenarios.\-hh\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tools/args.\-hh\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tools/help.\-hh\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tools/\-Logger.\-hh\char`\"{}}\\*
{\ttfamily \#include \char`\"{}tools/\-Progress\-Bar.\-hh\char`\"{}}\\*
\subsection*{Functions}
\begin{DoxyCompactItemize}
\item 
int \hyperlink{swe__mpi_8cpp_a98a81bc850455c1f9dc0621c31158a8e}{compute\-Number\-Of\-Block\-Rows} (int i\-\_\-number\-Of\-Processes)
\item 
void \hyperlink{swe__mpi_8cpp_af4bbac08d3d6b4b8f37920b3493d2ca0}{exchange\-Left\-Right\-Ghost\-Layers} (const int i\-\_\-left\-Neighbor\-Rank, \hyperlink{structSWE__Block1D}{S\-W\-E\-\_\-\-Block1\-D} $\ast$o\-\_\-left\-Inflow, \hyperlink{structSWE__Block1D}{S\-W\-E\-\_\-\-Block1\-D} $\ast$i\-\_\-left\-Outflow, const int i\-\_\-right\-Neighbor\-Rank, \hyperlink{structSWE__Block1D}{S\-W\-E\-\_\-\-Block1\-D} $\ast$o\-\_\-right\-Inflow, \hyperlink{structSWE__Block1D}{S\-W\-E\-\_\-\-Block1\-D} $\ast$i\-\_\-right\-Outflow, M\-P\-I\-\_\-\-Datatype i\-\_\-mpi\-Col)
\item 
void \hyperlink{swe__mpi_8cpp_a6f0b6c8879b6ead40fe956abe50c015a}{exchange\-Bottom\-Top\-Ghost\-Layers} (const int i\-\_\-bottom\-Neighbor\-Rank, \hyperlink{structSWE__Block1D}{S\-W\-E\-\_\-\-Block1\-D} $\ast$o\-\_\-bottom\-Neighbor\-Inflow, \hyperlink{structSWE__Block1D}{S\-W\-E\-\_\-\-Block1\-D} $\ast$i\-\_\-bottom\-Neighbor\-Outflow, const int i\-\_\-top\-Neighbor\-Rank, \hyperlink{structSWE__Block1D}{S\-W\-E\-\_\-\-Block1\-D} $\ast$o\-\_\-top\-Neighbor\-Inflow, \hyperlink{structSWE__Block1D}{S\-W\-E\-\_\-\-Block1\-D} $\ast$i\-\_\-top\-Neighbor\-Outflow, const M\-P\-I\-\_\-\-Datatype i\-\_\-mpi\-Row)
\item 
int \hyperlink{swe__mpi_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}{main} (int argc, char $\ast$$\ast$argv)
\end{DoxyCompactItemize}


\subsection{Detailed Description}
This file is part of S\-W\-E.

\begin{DoxyAuthor}{Author}
Michael Bader (bader A\-T in.\-tum.\-de, \href{http://www5.in.tum.de/wiki/index.php/Univ.-Prof._Dr._Michael_Bader}{\tt http\-://www5.\-in.\-tum.\-de/wiki/index.\-php/\-Univ.-\/\-Prof.\-\_\-\-Dr.\-\_\-\-Michael\-\_\-\-Bader}) 

Alexander Breuer (breuera A\-T in.\-tum.\-de, \href{http://www5.in.tum.de/wiki/index.php/Dipl.-Math._Alexander_Breuer}{\tt http\-://www5.\-in.\-tum.\-de/wiki/index.\-php/\-Dipl.-\/\-Math.\-\_\-\-Alexander\-\_\-\-Breuer}) 

Sebastian Rettenberger (rettenbs A\-T in.\-tum.\-de, \href{http://www5.in.tum.de/wiki/index.php/Sebastian_Rettenberger,_M.Sc}{\tt http\-://www5.\-in.\-tum.\-de/wiki/index.\-php/\-Sebastian\-\_\-\-Rettenberger,\-\_\-\-M.\-Sc}.)
\end{DoxyAuthor}
\hypertarget{Writer_8hh_LICENSE}{}\subsection{L\-I\-C\-E\-N\-S\-E}\label{Writer_8hh_LICENSE}
S\-W\-E is free software\-: you can redistribute it and/or modify it under the terms of the G\-N\-U General Public License as published by the Free Software Foundation, either version 3 of the License, or (at your option) any later version.

S\-W\-E is distributed in the hope that it will be useful, but W\-I\-T\-H\-O\-U\-T A\-N\-Y W\-A\-R\-R\-A\-N\-T\-Y; without even the implied warranty of M\-E\-R\-C\-H\-A\-N\-T\-A\-B\-I\-L\-I\-T\-Y or F\-I\-T\-N\-E\-S\-S F\-O\-R A P\-A\-R\-T\-I\-C\-U\-L\-A\-R P\-U\-R\-P\-O\-S\-E. See the G\-N\-U General Public License for more details.

You should have received a copy of the G\-N\-U General Public License along with S\-W\-E. If not, see \href{http://www.gnu.org/licenses/}{\tt http\-://www.\-gnu.\-org/licenses/}.\hypertarget{NetCdfWriter_8hh_DESCRIPTION}{}\subsection{D\-E\-S\-C\-R\-I\-P\-T\-I\-O\-N}\label{NetCdfWriter_8hh_DESCRIPTION}
Setting of S\-W\-E, which uses a wave propagation solver and an artificial or A\-S\-A\-G\-I scenario on multiple blocks. 

\subsection{Function Documentation}
\hypertarget{swe__mpi_8cpp_a98a81bc850455c1f9dc0621c31158a8e}{\index{swe\-\_\-mpi.\-cpp@{swe\-\_\-mpi.\-cpp}!compute\-Number\-Of\-Block\-Rows@{compute\-Number\-Of\-Block\-Rows}}
\index{compute\-Number\-Of\-Block\-Rows@{compute\-Number\-Of\-Block\-Rows}!swe_mpi.cpp@{swe\-\_\-mpi.\-cpp}}
\subsubsection[{compute\-Number\-Of\-Block\-Rows}]{\setlength{\rightskip}{0pt plus 5cm}int compute\-Number\-Of\-Block\-Rows (
\begin{DoxyParamCaption}
\item[{int}]{i\-\_\-number\-Of\-Processes}
\end{DoxyParamCaption}
)}}\label{swe__mpi_8cpp_a98a81bc850455c1f9dc0621c31158a8e}
Compute the number of block rows from the total number of processes.

The number of rows is determined as the square root of the number of processes, if this is a square number; otherwise, we use the largest number that is smaller than the square root and still a divisor of the number of processes.


\begin{DoxyParams}{Parameters}
{\em num\-Procs} & number of process. \\
\hline
\end{DoxyParams}
\begin{DoxyReturn}{Returns}
number of block rows 
\end{DoxyReturn}
\hypertarget{swe__mpi_8cpp_a6f0b6c8879b6ead40fe956abe50c015a}{\index{swe\-\_\-mpi.\-cpp@{swe\-\_\-mpi.\-cpp}!exchange\-Bottom\-Top\-Ghost\-Layers@{exchange\-Bottom\-Top\-Ghost\-Layers}}
\index{exchange\-Bottom\-Top\-Ghost\-Layers@{exchange\-Bottom\-Top\-Ghost\-Layers}!swe_mpi.cpp@{swe\-\_\-mpi.\-cpp}}
\subsubsection[{exchange\-Bottom\-Top\-Ghost\-Layers}]{\setlength{\rightskip}{0pt plus 5cm}void exchange\-Bottom\-Top\-Ghost\-Layers (
\begin{DoxyParamCaption}
\item[{const int}]{i\-\_\-bottom\-Neighbor\-Rank, }
\item[{{\bf S\-W\-E\-\_\-\-Block1\-D} $\ast$}]{o\-\_\-bottom\-Neighbor\-Inflow, }
\item[{{\bf S\-W\-E\-\_\-\-Block1\-D} $\ast$}]{i\-\_\-bottom\-Neighbor\-Outflow, }
\item[{const int}]{i\-\_\-top\-Neighbor\-Rank, }
\item[{{\bf S\-W\-E\-\_\-\-Block1\-D} $\ast$}]{o\-\_\-top\-Neighbor\-Inflow, }
\item[{{\bf S\-W\-E\-\_\-\-Block1\-D} $\ast$}]{i\-\_\-top\-Neighbor\-Outflow, }
\item[{const M\-P\-I\-\_\-\-Datatype}]{i\-\_\-mpi\-Row}
\end{DoxyParamCaption}
)}}\label{swe__mpi_8cpp_a6f0b6c8879b6ead40fe956abe50c015a}
Exchanges the bottom and top ghost layers with M\-P\-I's Send\-Receive.


\begin{DoxyParams}{Parameters}
{\em i\-\_\-bottom\-Neighbor\-Rank} & M\-P\-I rank of the bottom neighbor. \\
\hline
{\em o\-\_\-bottom\-Neighbor\-Inflow} & ghost layer, where the bottom neighbor writes into. \\
\hline
{\em i\-\_\-bottom\-Neighbor\-Outflow} & host layer, where the bottom neighbor reads from. \\
\hline
{\em i\-\_\-top\-Neighbor\-Rank} & M\-P\-I rank of the top neighbor. \\
\hline
{\em o\-\_\-top\-Neighbor\-Inflow} & ghost layer, where the top neighbor writes into. \\
\hline
{\em i\-\_\-top\-Neighbor\-Outflow} & ghost layer, where the top neighbor reads from. \\
\hline
{\em i\-\_\-mpi\-Row} & M\-P\-I data type for the horizontal ghost layers. \\
\hline
\end{DoxyParams}
\hypertarget{swe__mpi_8cpp_af4bbac08d3d6b4b8f37920b3493d2ca0}{\index{swe\-\_\-mpi.\-cpp@{swe\-\_\-mpi.\-cpp}!exchange\-Left\-Right\-Ghost\-Layers@{exchange\-Left\-Right\-Ghost\-Layers}}
\index{exchange\-Left\-Right\-Ghost\-Layers@{exchange\-Left\-Right\-Ghost\-Layers}!swe_mpi.cpp@{swe\-\_\-mpi.\-cpp}}
\subsubsection[{exchange\-Left\-Right\-Ghost\-Layers}]{\setlength{\rightskip}{0pt plus 5cm}void exchange\-Left\-Right\-Ghost\-Layers (
\begin{DoxyParamCaption}
\item[{const int}]{i\-\_\-left\-Neighbor\-Rank, }
\item[{{\bf S\-W\-E\-\_\-\-Block1\-D} $\ast$}]{o\-\_\-left\-Inflow, }
\item[{{\bf S\-W\-E\-\_\-\-Block1\-D} $\ast$}]{i\-\_\-left\-Outflow, }
\item[{const int}]{i\-\_\-right\-Neighbor\-Rank, }
\item[{{\bf S\-W\-E\-\_\-\-Block1\-D} $\ast$}]{o\-\_\-right\-Inflow, }
\item[{{\bf S\-W\-E\-\_\-\-Block1\-D} $\ast$}]{i\-\_\-right\-Outflow, }
\item[{M\-P\-I\-\_\-\-Datatype}]{i\-\_\-mpi\-Col}
\end{DoxyParamCaption}
)}}\label{swe__mpi_8cpp_af4bbac08d3d6b4b8f37920b3493d2ca0}
Exchanges the left and right ghost layers with M\-P\-I's Send\-Receive.


\begin{DoxyParams}{Parameters}
{\em i\-\_\-left\-Neighbor\-Rank} & M\-P\-I rank of the left neighbor. \\
\hline
{\em o\-\_\-left\-Inflow} & ghost layer, where the left neighbor writes into. \\
\hline
{\em i\-\_\-left\-Outflow} & layer where the left neighbor reads from. \\
\hline
{\em i\-\_\-right\-Neighbor\-Rank} & M\-P\-I rank of the right neighbor. \\
\hline
{\em o\-\_\-right\-Inflow} & ghost layer, where the right neighbor writes into. \\
\hline
{\em i\-\_\-right\-Outflow} & layer, where the right neighbor reads form. \\
\hline
{\em i\-\_\-mpi\-Col} & M\-P\-I data type for the vertical gost layers. \\
\hline
\end{DoxyParams}
\hypertarget{swe__mpi_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}{\index{swe\-\_\-mpi.\-cpp@{swe\-\_\-mpi.\-cpp}!main@{main}}
\index{main@{main}!swe_mpi.cpp@{swe\-\_\-mpi.\-cpp}}
\subsubsection[{main}]{\setlength{\rightskip}{0pt plus 5cm}int main (
\begin{DoxyParamCaption}
\item[{int}]{argc, }
\item[{char $\ast$$\ast$}]{argv}
\end{DoxyParamCaption}
)}}\label{swe__mpi_8cpp_a3c04138a5bfe5d72780bb7e82a18e627}
Main program for the simulation on a single \hyperlink{classSWE__WavePropagationBlock}{S\-W\-E\-\_\-\-Wave\-Propagation\-Block} or \hyperlink{classSWE__WaveAccumulationBlock}{S\-W\-E\-\_\-\-Wave\-Accumulation\-Block}. Initialization.

M\-P\-I Rank of a process.

number of M\-P\-I processes.

total number of grid cell in x-\/ and y-\/direction.

l\-\_\-base\-Name of the plots.

number of S\-W\-E\-\_\-\-Blocks in x-\/ and y-\/direction.

local position of each M\-P\-I process in x-\/ and y-\/direction.

number of checkpoints for visualization (at each checkpoint in time, an output file is written).

number of grid cells in x-\/ and y-\/direction per process.

size of a single cell in x-\/ and y-\/direction

origin of the simulation domain in x-\/ and y-\/direction

time when the simulation ends.

checkpoints when output files are written.

M\-P\-I row-\/vector\-: l\-\_\-n\-X\-Local+2 blocks, 1 element per block, stride of l\-\_\-n\-Y\-Local+2

M\-P\-I row-\/vector\-: 1 block, l\-\_\-n\-Y\-Local+2 elements per block, stride of 1

M\-P\-I ranks of the neighbors

\hyperlink{classSimulation}{Simulation}.

simulation time.

maximum allowed time step width within a block.

maximum allowed time steps of all blocks

Finalize.